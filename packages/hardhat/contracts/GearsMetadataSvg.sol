pragma solidity ^0.8.0;

import "base64-sol/base64.sol";
import "@openzeppelin/contracts/utils/Strings.sol";

/// @title NFTSVG
/// @notice Provides a function for generating an SVG associated with a Uniswap NFT
library GearsMetadataSvg {
    using Strings for uint256;

    function generateSVGofTokenById(
        string memory cat,
        string memory itemName,
        uint256 rarityLevel
    ) internal pure returns (string memory) {
        string memory rarity = "Common";
        if (rarityLevel == 1) {
            rarity = "Uncommon";
        } else if (rarityLevel == 2) {
            rarity = "Rare";
        } else if (rarityLevel == 3) {
            rarity = "Ultra Rare";
        }
        string memory svg = string(
            abi.encodePacked(
                '<svg width="400" height="400" xmlns="http://www.w3.org/2000/svg">',
                "<style>.title {fill: white; font-family: serif; font-size: 16px;}.subtitle  {fill: white; font-family: serif; font-size: 16px;}.base { fill: white; font-family: serif; font-size: 24px; }.quote { fill: black; font-family: serif; font-size: 12px; font-style = italic; }.note{fill: white; font-size: 16px;}</style>",
                '<rect width="100%" height="100%" fill="black"/>'
            )
        );
        // svg = string(
        //     abi.encodePacked(
        //         svg,
        //         '<svg id="svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="400" height="400" viewBox="0, 0, 400,400"><g id="svgg"><path id="path0" d="M266.345 3.501 C 240.826 7.800,243.570 5.533,155.106 95.437 C 114.372 136.833,75.661 175.977,69.083 182.422 C 55.364 195.862,45.589 209.674,51.367 207.454 C 61.026 203.744,74.754 200.781,82.293 200.781 L 87.070 200.781 167.949 120.027 C 221.672 66.386,250.487 38.165,253.770 35.974 C 298.535 6.088,360.768 46.430,349.740 98.186 C 346.099 115.271,344.987 116.703,300.815 161.133 L 262.173 200.000 280.125 200.000 L 298.076 200.000 326.269 171.680 C 360.258 137.538,366.124 129.541,371.026 110.669 C 387.441 47.468,333.451 -7.804,266.345 3.501 M151.566 169.908 L 121.492 200.000 181.151 200.000 L 240.810 200.000 225.212 183.789 C 216.634 174.873,203.741 161.426,196.563 153.906 C 189.384 146.387,183.090 140.140,182.576 140.025 C 182.061 139.910,168.107 153.357,151.566 169.908 M71.094 226.160 C -19.870 244.312,-24.126 372.443,65.404 397.473 L 73.047 399.609 200.000 399.609 L 326.953 399.609 334.664 397.454 C 424.425 372.370,419.657 243.586,328.320 226.110 C 320.121 224.541,78.971 224.588,71.094 226.160 M327.734 252.185 C 390.203 269.750,389.978 355.483,327.417 372.869 C 321.662 374.468,319.666 374.526,260.742 374.814 L 200.000 375.110 200.000 325.029 L 200.000 274.948 136.523 275.188 C 73.155 275.427,73.037 275.431,67.295 277.194 C 52.349 281.784,40.414 288.770,29.709 299.197 C 25.232 303.558,25.199 303.386,28.611 293.429 C 36.614 270.076,57.768 253.148,81.915 250.775 C 85.202 250.452,140.449 250.241,204.688 250.307 L 321.484 250.427 327.734 252.185 " stroke="none" fill="red" fill-rule="evenodd"></path></g></svg>'
        //     )
        // );
        // svg = string(
        //     abi.encodePacked(
        //         svg,
        //         '<svg id="svg" viewBox="0, 0, 400,400"><g id="svgg"><path id="path0" d="M202.942 19.598 C 201.539 20.923,200.830 21.782,201.367 21.505 C 202.627 20.856,202.597 21.318,201.162 24.754 C 200.511 26.311,200.160 27.764,200.380 27.985 C 200.601 28.205,200.803 27.887,200.830 27.279 C 200.898 25.746,204.270 35.995,206.253 43.760 C 221.844 104.825,206.730 178.246,165.750 240.515 C 159.252 250.388,159.443 251.931,168.101 259.576 C 174.914 265.592,173.458 266.694,150.391 272.983 C 142.714 275.076,137.754 277.043,130.078 281.040 L 119.922 286.328 104.614 286.374 C 90.311 286.417,89.117 286.532,86.406 288.132 C 83.074 290.097,82.500 290.232,83.274 288.867 C 83.579 288.330,82.545 289.102,80.977 290.583 C 79.408 292.064,78.125 293.563,78.125 293.916 C 78.125 294.268,79.092 293.567,80.273 292.358 C 81.455 291.148,81.855 290.879,81.163 291.759 C 79.704 293.614,77.933 298.506,78.512 299.085 C 78.729 299.302,78.907 298.981,78.907 298.372 C 78.907 297.764,79.962 299.496,81.252 302.221 C 82.541 304.947,83.365 307.550,83.084 308.006 C 82.759 308.532,82.950 308.601,83.606 308.196 C 84.345 307.739,84.506 307.907,84.169 308.785 C 83.073 311.642,92.514 322.361,99.077 325.709 C 103.973 328.207,104.082 327.627,99.219 324.952 C 94.143 322.160,88.415 316.740,86.001 312.446 C 83.673 308.304,84.500 308.517,86.971 312.695 C 89.697 317.306,94.147 321.415,99.659 324.410 C 104.063 326.803,104.352 327.137,104.566 330.078 C 104.991 335.921,107.082 343.301,109.981 349.197 C 111.572 352.432,112.882 355.493,112.892 356.000 C 112.902 356.506,113.226 357.209,113.612 357.562 C 114.023 357.938,114.038 357.719,113.647 357.031 C 113.073 356.021,113.164 356.007,114.303 356.932 C 115.828 358.168,116.106 359.748,114.648 358.896 C 114.111 358.582,114.342 359.089,115.160 360.022 C 116.938 362.048,117.818 362.295,116.336 360.352 C 115.763 359.600,116.423 360.017,117.803 361.279 C 120.625 363.859,121.283 365.901,118.555 363.610 C 117.588 362.798,117.852 363.302,119.141 364.729 C 122.439 368.381,130.046 373.983,135.324 376.647 C 141.913 379.973,141.944 379.358,135.363 375.864 C 129.474 372.738,120.778 366.462,121.431 365.809 C 121.638 365.602,123.492 366.916,125.552 368.730 C 138.107 379.787,145.896 381.250,192.188 381.250 C 238.479 381.250,246.268 379.787,258.823 368.730 C 260.883 366.916,262.737 365.602,262.944 365.809 C 263.597 366.462,254.901 372.738,249.012 375.864 C 242.431 379.358,242.462 379.973,249.051 376.647 C 254.329 373.983,261.936 368.381,265.234 364.729 C 266.523 363.302,266.787 362.798,265.820 363.610 C 263.092 365.901,263.750 363.859,266.572 361.279 C 267.952 360.017,268.573 359.688,267.952 360.547 C 266.835 362.093,266.842 362.094,268.568 360.621 C 270.355 359.096,270.930 358.120,269.531 358.984 C 268.212 359.800,268.667 358.071,270.072 356.932 C 271.211 356.007,271.302 356.021,270.728 357.031 C 270.337 357.719,270.352 357.938,270.763 357.562 C 271.149 357.209,271.473 356.506,271.483 356.000 C 271.493 355.493,272.803 352.432,274.394 349.197 C 277.388 343.109,279.477 335.647,279.805 329.870 C 279.988 326.654,280.142 326.469,284.194 324.614 C 286.503 323.557,289.968 321.629,291.892 320.330 C 295.717 317.749,296.492 317.459,295.599 318.945 C 295.201 319.609,295.436 319.578,296.334 318.850 C 297.874 317.601,298.103 316.827,296.680 317.682 C 296.016 318.081,296.047 317.845,296.775 316.947 C 298.014 315.420,299.576 315.149,298.767 316.602 C 298.467 317.139,300.755 315.117,303.851 312.109 C 310.449 305.698,317.363 295.899,316.633 293.994 C 316.362 293.289,316.464 292.912,316.859 293.157 C 317.255 293.401,317.637 292.843,317.710 291.918 C 317.782 290.992,318.930 287.177,320.261 283.439 C 321.904 278.823,323.002 273.687,323.685 267.424 C 324.715 257.972,327.780 249.993,329.883 251.292 C 330.338 251.574,330.483 251.437,330.206 250.988 C 329.928 250.539,331.432 246.530,333.548 242.078 C 357.102 192.521,353.095 133.524,323.133 88.712 C 317.823 80.770,317.411 80.032,318.750 80.859 C 320.022 81.645,319.640 80.749,318.209 79.588 C 317.069 78.663,316.982 78.677,317.578 79.688 C 318.174 80.698,318.087 80.712,316.947 79.787 C 315.424 78.552,315.140 76.955,316.602 77.848 C 317.870 78.622,311.805 71.334,306.004 65.111 C 301.320 60.088,291.048 51.151,285.547 47.313 C 281.897 44.767,283.619 46.292,293.582 54.434 C 297.572 57.694,300.661 60.537,300.445 60.752 C 300.230 60.968,298.020 59.281,295.535 57.004 C 288.195 50.280,275.734 41.462,267.989 37.510 C 266.229 36.612,264.995 35.544,265.247 35.135 C 265.510 34.711,265.132 34.613,264.366 34.907 C 263.462 35.254,263.207 35.127,263.584 34.517 C 263.961 33.907,263.706 33.779,262.803 34.126 C 261.900 34.473,261.645 34.345,262.022 33.735 C 262.399 33.126,262.144 32.998,261.241 33.345 C 260.499 33.630,260.098 33.538,260.344 33.141 C 260.588 32.745,260.031 32.375,259.105 32.318 C 258.179 32.261,253.906 30.739,249.609 28.936 C 233.440 22.153,208.459 17.168,204.189 19.872 C 202.050 21.226,202.011 21.227,203.292 19.880 C 204.028 19.105,206.138 18.227,207.979 17.928 L 211.328 17.383 208.411 17.285 C 206.145 17.209,204.924 17.726,202.942 19.598 M254.688 30.078 C 255.762 30.692,256.992 31.195,257.422 31.195 C 257.852 31.195,257.324 30.692,256.250 30.078 C 255.176 29.464,253.945 28.962,253.516 28.962 C 253.086 28.962,253.613 29.464,254.688 30.078 M266.406 35.507 C 266.406 35.722,267.461 36.443,268.750 37.109 C 270.039 37.776,271.094 38.146,271.094 37.931 C 271.094 37.716,270.039 36.995,268.750 36.328 C 267.461 35.662,266.406 35.292,266.406 35.507 M275.781 40.868 C 275.781 41.050,277.275 42.184,279.102 43.388 C 280.928 44.593,282.009 45.079,281.505 44.469 C 280.536 43.295,275.781 40.304,275.781 40.868 M313.388 74.539 L 315.773 77.734 313.160 74.871 C 311.723 73.297,308.313 69.430,305.582 66.278 L 300.617 60.547 305.810 65.945 C 308.667 68.914,312.077 72.781,313.388 74.539 M323.155 87.500 C 325.155 90.508,326.937 92.969,327.114 92.969 C 327.529 92.969,326.948 91.995,323.272 86.523 C 321.612 84.053,320.089 82.031,319.887 82.031 C 319.684 82.031,321.155 84.492,323.155 87.500 M332.978 104.268 C 334.781 107.904,336.383 110.753,336.537 110.598 C 336.884 110.251,330.596 97.656,330.075 97.656 C 329.868 97.656,331.174 100.631,332.978 104.268 M339.510 118.750 C 339.798 119.824,340.359 121.230,340.757 121.875 C 341.260 122.689,341.322 122.451,340.958 121.094 C 340.671 120.020,340.110 118.613,339.712 117.969 C 339.209 117.154,339.147 117.393,339.510 118.750 M343.079 128.906 C 343.079 129.551,343.381 130.781,343.750 131.641 C 344.173 132.625,344.421 132.770,344.421 132.031 C 344.421 131.387,344.119 130.156,343.750 129.297 C 343.327 128.312,343.079 128.168,343.079 128.906 M348.619 154.688 C 348.619 156.191,348.780 156.807,348.976 156.055 C 349.173 155.303,349.173 154.072,348.976 153.320 C 348.780 152.568,348.619 153.184,348.619 154.688 M349.442 162.891 C 349.448 165.039,349.600 165.825,349.779 164.638 C 349.959 163.450,349.954 161.692,349.769 160.731 C 349.583 159.771,349.436 160.742,349.442 162.891 M269.719 177.288 C 281.209 181.707,291.406 194.632,291.406 204.776 C 291.406 206.861,291.345 206.888,288.477 206.090 C 286.833 205.633,282.717 205.473,279.102 205.725 C 273.937 206.085,272.656 205.961,272.656 205.100 C 272.656 203.241,268.553 199.055,265.267 197.562 C 251.692 191.396,238.981 207.881,248.335 219.520 L 250.756 222.534 248.401 227.568 C 247.105 230.336,245.833 234.390,245.574 236.576 L 245.104 240.550 241.972 238.953 C 205.119 220.151,231.091 162.431,269.719 177.288 M121.129 181.290 C 98.488 185.939,90.718 214.894,108.041 230.062 C 126.910 246.582,156.287 231.927,154.496 206.888 C 153.308 190.281,137.268 177.976,121.129 181.290 M349.442 186.328 C 349.448 188.477,349.600 189.263,349.779 188.075 C 349.959 186.888,349.954 185.130,349.769 184.169 C 349.583 183.208,349.436 184.180,349.442 186.328 M348.619 194.531 C 348.619 196.035,348.780 196.650,348.976 195.898 C 349.173 195.146,349.173 193.916,348.976 193.164 C 348.780 192.412,348.619 193.027,348.619 194.531 M343.415 218.415 C 343.128 219.560,343.043 220.648,343.228 220.832 C 343.412 221.016,343.797 220.230,344.085 219.085 C 344.372 217.940,344.457 216.852,344.272 216.668 C 344.088 216.484,343.703 217.270,343.415 218.415 M339.931 228.993 C 339.449 230.374,339.192 231.640,339.359 231.807 C 339.526 231.974,340.057 230.981,340.538 229.601 C 341.019 228.220,341.277 226.954,341.109 226.787 C 340.942 226.619,340.412 227.612,339.931 228.993 M337.627 234.799 C 336.318 237.672,336.568 238.285,337.983 235.673 C 338.644 234.453,339.039 233.309,338.860 233.131 C 338.681 232.952,338.126 233.703,337.627 234.799 M64.220 238.655 C 65.155 240.579,66.054 242.019,66.217 241.855 C 66.571 241.502,63.414 235.156,62.885 235.156 C 62.684 235.156,63.285 236.731,64.220 238.655 M333.367 244.168 C 331.780 247.376,330.650 250.000,330.856 250.000 " stroke="none" fill="red" fill-rule="evenodd"></path></g></svg>'
        //     )
        // );
        svg = string(
            abi.encodePacked(
                svg,
                '<text x="50%" y="8%" dominant-baseline="middle" text-anchor="middle" class="base">',
                itemName,
                '</text><text x="50%" y="15%" dominant-baseline="middle" text-anchor="middle" class="title">',
                rarity
            )
        );
        svg = string(
            abi.encodePacked(
                svg,
                '</text><text x="50%" y="65%" dominant-baseline="middle" text-anchor="middle" class="base">',
                cat
            )
        );
        svg = string(
            abi.encodePacked(
                svg,
                '</text><text x="50%" y="83%" dominant-baseline="middle" text-anchor="middle" class="subtitle">',
                "Manufacturer: Black Hole Division"
            )
        );
        svg = string(
            abi.encodePacked(
                svg,
                '</text><text x="50%" y="95%" dominant-baseline="middle" text-anchor="middle" class="base" font-style="italic">',
                "Dropped by alien named Moloch",
                "</text>",
                "</svg>"
            )
        );
        return svg;
    }

    function tokenURI(
        uint256 tokenId,
        string memory cat,
        string memory itemName,
        uint256 rarityLevel
    ) internal pure returns (string memory) {
        string memory name = string(
            abi.encodePacked("Gears #", tokenId.toString())
        );
        string memory image = Base64.encode(
            bytes(generateSVGofTokenById(cat, itemName, rarityLevel))
        );
        return
            string(
                abi.encodePacked(
                    "data:application/json;base64,",
                    Base64.encode(
                        bytes(
                            abi.encodePacked(
                                '{"name":"',
                                name,
                                '", "category": "',
                                cat,
                                '", "item": "',
                                itemName,
                                '", "rarityLevel": "',
                                rarityLevel.toString(),
                                '", "image": "',
                                "data:image/svg+xml;base64,",
                                image,
                                '"}'
                            )
                        )
                    )
                )
            );
    }
}
